{
    "componentChunkName": "component---src-templates-blog-template-js",
    "path": "/Django(8)-User Model/",
    "result": {"data":{"cur":{"id":"547ad7ca-81ab-59f0-8b59-28fabce02cf6","html":"<p>이전까지 장고와 리액트 서버를 연결해보았고, 이때 생길 수 있는 문제인 CORS 정책을 해결하는 것까지 알아보았다. 오늘은 간단하게 장고에서 지원하는 사용자 모델에 대하여 알아보고, 회원가입과 로그인/로그아웃 등의 기능을 구현해보자.</p>\n<h2 id=\"장고에서-제공하는-user-model\" style=\"position:relative;\"><a href=\"#%EC%9E%A5%EA%B3%A0%EC%97%90%EC%84%9C-%EC%A0%9C%EA%B3%B5%ED%95%98%EB%8A%94-user-model\" aria-label=\"장고에서 제공하는 user model permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>장고에서 제공하는 User Model</h2>\n<p>장고에서는 사용자와 관련한 많은 기능들이 포함된 User Model class가 기본적으로 제공된다. <a href=\"https://docs.djangoproject.com/en/4.2/ref/contrib/auth/\">공식문서</a></p>\n<p>settings.py에서 User관련한 것들을 추가하지 않고 migration을 진행하였다면 DB에 auth_~로 시작하는 테이블이 만들어져있을 것이다. 하지만, 여기서 제공하는 user의 필드는 id, password, last_login, is_superuser, username, first_name, last_name, email, is_staff, is_active, date_joined 정도이다. 로그인은 username과 password를 기반으로 이루어지며, is_active한 사용자만 authentication이 가능할 것이다.</p>\n<p>만약, 기본적인 user model를 커스텀하고 싶다면 어떻게 해야할까? 크게 몇가지 방법이 있다고 하지만, 마이그레이션까지 완료한 우리의 상태에서는 가장 간단한 1:1 model을 만드는 방법으로 사용자 모델을 확장시켜보도록 하자.</p>\n<h3 id=\"1--1-model을-이용한-user-model-확장\" style=\"position:relative;\"><a href=\"#1--1-model%EC%9D%84-%EC%9D%B4%EC%9A%A9%ED%95%9C-user-model-%ED%99%95%EC%9E%A5\" aria-label=\"1  1 model을 이용한 user model 확장 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1 : 1 model을 이용한 user model 확장</h3>\n<p>회원과 관련된 새로운 app을 만들어서 관리하도록 하자.</p>\n<p><code class=\"language-text\">python manage.py startapp myuser</code> 로 새로운 앱을 만들어주었다. settings.py의 INSTALLED_APPS에도 <code class=\"language-text\">myuser</code>를 추가해주었다.</p>\n<p>myuser/model.py에서 다음과 같이 작성하자.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> django<span class=\"token punctuation\">.</span>db <span class=\"token keyword\">import</span> models\n<span class=\"token keyword\">from</span> django<span class=\"token punctuation\">.</span>contrib<span class=\"token punctuation\">.</span>auth<span class=\"token punctuation\">.</span>models <span class=\"token keyword\">import</span> User\n<span class=\"token comment\"># Create your models here.</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Profile</span><span class=\"token punctuation\">(</span>models<span class=\"token punctuation\">.</span>Model<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># OneToOne Field로 django의 User model과 연결</span>\n    user <span class=\"token operator\">=</span> models<span class=\"token punctuation\">.</span>OneToOneField<span class=\"token punctuation\">(</span>User<span class=\"token punctuation\">,</span> on_delete<span class=\"token operator\">=</span>models<span class=\"token punctuation\">.</span>CASCADE<span class=\"token punctuation\">,</span> primary_key<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\n    <span class=\"token comment\"># additional fields</span>\n    phone_number <span class=\"token operator\">=</span> models<span class=\"token punctuation\">.</span>CharField<span class=\"token punctuation\">(</span>max_length<span class=\"token operator\">=</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span> blank<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\n    address <span class=\"token operator\">=</span> models<span class=\"token punctuation\">.</span>CharField<span class=\"token punctuation\">(</span>max_length<span class=\"token operator\">=</span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span> blank<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\n\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__str__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">return</span> self<span class=\"token punctuation\">.</span>username</code></pre></div>\n<p><code class=\"language-text\">python manage.py makemigrations myuser</code> 와 <code class=\"language-text\">python manage.py migrate myuser</code> 명령어로 마이그레이션을 적용해준다.</p>\n<p>이제, 로그인과 회원가입을 처리해주자!</p>\n<h3 id=\"로그인과-회원가입\" style=\"position:relative;\"><a href=\"#%EB%A1%9C%EA%B7%B8%EC%9D%B8%EA%B3%BC-%ED%9A%8C%EC%9B%90%EA%B0%80%EC%9E%85\" aria-label=\"로그인과 회원가입 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>로그인과 회원가입</h3>\n<p>우리는 django의 user model을 사용하므로, user class에서 제공하는 함수(로그인, 로그아웃, 회원가입 등) 역시 모두 사용할 수 있다.</p>\n<h3 id=\"csrf-\" style=\"position:relative;\"><a href=\"#csrf-\" aria-label=\"csrf  permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>CSRF ?</h3>","excerpt":"이전까지 장고와 리액트 서버를 연결해보았고, 이때 생길 수 있는 문제인 CORS 정책을 해결하는 것까지 알아보았다. 오늘은 간단하게 장고에서 지원하는 사용자 모델에 대하여 알아보고, 회원가입과 로그인/로그아웃 등의 기능을 구현해보자. 장고에서 제공하는 User Model 장고에서는 사용자와 관련한 많은 기능들이 포함된 User Model class가 기본적으로 제공된다. 공식문서 settings.py에서 User관련한 것들을 추가하지 않고 migration을 진행하였다면 DB에 auth_~로 시작하는 테이블이 만들어져있을 것이다. 하지만, 여기서 제공하는 user의 필드는 id, password, last_login, is_superuser, username, first_name, last_name, email, is_staff, is_active, date_joined 정도이다. 로그인은 username과 password를 기반으로 이루어지며, is_active한 사용자만 aut…","frontmatter":{"date":"April 23, 2022","title":"(Django) 장고 api 서버를 이용한 프로젝트 [8-django user model (1 to 1)]","categories":"BE","author":"choieastsea","emoji":"🙄"},"fields":{"slug":"/Django(8)-User Model/"}},"next":{"id":"2216b6bb-30a6-5f7e-8c55-546e561f0708","html":"<p>이전까지 DRF의 CBV를 어떻게 구현하는지 알아보았다. ModelViewSet이 가장 간단하게 구현이 가능했는데, 이를 기반으로 검색기능을 만들어보자.</p>\n<p>Item 모델의 이름(name)에 해당 검색어가 포함되는지를 판단하여 리턴하는 api를 기존 ModelViewSet에다가 만들어보려고 한다. 그리고 가능하다면 실제 브라우저와 연결해보도록 하자!!</p>\n<blockquote>\n<p>요구사항</p>\n<p>[GET] localhost:8000/item/search?name=I</p>\n<p>I를 포함한 name을 갖는 item list를 리턴하도록</p>\n</blockquote>\n<p>우선, 앞으로는 ModelViewSet으로만 처리하기 위해 items/urls.py를 간단하게 해주었다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> django<span class=\"token punctuation\">.</span>urls <span class=\"token keyword\">import</span> path<span class=\"token punctuation\">,</span> include\n<span class=\"token keyword\">from</span> item <span class=\"token keyword\">import</span> views\n<span class=\"token keyword\">from</span> rest_framework <span class=\"token keyword\">import</span> routers\n\nrouter <span class=\"token operator\">=</span> routers<span class=\"token punctuation\">.</span>DefaultRouter<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nrouter<span class=\"token punctuation\">.</span>register<span class=\"token punctuation\">(</span><span class=\"token string\">r'basic'</span><span class=\"token punctuation\">,</span> views<span class=\"token punctuation\">.</span>ItemModelViewSet<span class=\"token punctuation\">)</span>\n\nurlpatterns <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n    path<span class=\"token punctuation\">(</span><span class=\"token string\">''</span><span class=\"token punctuation\">,</span> include<span class=\"token punctuation\">(</span>router<span class=\"token punctuation\">.</span>urls<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">]</span></code></pre></div>\n<h2 id=\"modelviewset-클래스-수정\" style=\"position:relative;\"><a href=\"#modelviewset-%ED%81%B4%EB%9E%98%EC%8A%A4-%EC%88%98%EC%A0%95\" aria-label=\"modelviewset 클래스 수정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ModelViewSet 클래스 수정</h2>\n<h3 id=\"code-classlanguage-textget_querysetcode-오버라이딩\" style=\"position:relative;\"><a href=\"#code-classlanguage-textget_querysetcode-%EC%98%A4%EB%B2%84%EB%9D%BC%EC%9D%B4%EB%94%A9\" aria-label=\"code classlanguage textget_querysetcode 오버라이딩 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><code class=\"language-text\">get_queryset()</code> 오버라이딩</h3>\n<p>ModelViewSet에서는 질의가 들어왔을 때, 내부적으로 <code class=\"language-text\">get_queryset()</code>함수를 사용한다. 따라서 이를 오버라이딩하여 쿼리 문자열을 처리할 수 있다. 쿼리 문자열은 <code class=\"language-text\">request.query_params.get()</code>으로 접근할 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">ItemModelViewSet</span><span class=\"token punctuation\">(</span>viewsets<span class=\"token punctuation\">.</span>ModelViewSet<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n\t\t<span class=\"token keyword\">def</span> <span class=\"token function\">get_queryset</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        queryset <span class=\"token operator\">=</span> Item<span class=\"token punctuation\">.</span>objects<span class=\"token punctuation\">.</span><span class=\"token builtin\">all</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        name <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>request<span class=\"token punctuation\">.</span>query_params<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'name'</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">if</span> name <span class=\"token keyword\">is</span> <span class=\"token keyword\">not</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">:</span>\n            queryset <span class=\"token operator\">=</span> queryset<span class=\"token punctuation\">.</span><span class=\"token builtin\">filter</span><span class=\"token punctuation\">(</span>name__icontains<span class=\"token operator\">=</span>name<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">return</span> queryset</code></pre></div>\n<p>Django ORM에서 <code class=\"language-text\">{fields}__icontains</code>를 하면 해당 문자열(대소문자 구분 없이)이 포함되는지 여부를 판단한다.</p>\n<p>따라서, 결과는 다음과 같이 잘 나올 것이다.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 115.00000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAXCAYAAAALHW+jAAAACXBIWXMAABYlAAAWJQFJUiTwAAACB0lEQVQ4y61V7ZKrIAzlRVpUEAQRUGt39rZ77/s/1dlJqh13q7vtzP2RIcRwyMcJimEY0OeMpmngvUdKCdM04XQ68Xo+n+97kr7v4ZzbFRFTQugirLUM2nUd+JK+Z1n0ZY0xst+eiNY1OA0JhSrQ2FuUdV2jqiq03kM1Ncqq5AvJRofatmU/rTXbab1HOMaAf+cRQ06ojUFZlnxwWdf62lYUBe/XQnZxOByhjeEby/LR6bsQkDGGU9/6Li6XC67XK4f+G9giSimWTcBxHLmTlP9/ATwcDpBS3mv0LCA1bhNwXZtnAcl3z198d/yiz/sFYC17diFXH1+NdDPCPnbQWjFhiaDeeRhnoaxmGzWL7FRnErpQ/pTy37cJH5c/CKFDCIEBaBx961nP85wTrWgsdV3DWQOt1GbqIucexEUiKpGbDhIw6QS0zC7tc043UnsHQ1FvRCkoDaUqdlxSOh6PtxTXupSsc8qy2K25IP5RjWglfhnXogmRL6iIczy7+/R5iHANWBQScXpHGM7IscX724jgGwZ8tvtfAOkgRediho8ZIXUwtuYUn6WUIJBlNmmcboequZbyDlb+QJWHCLle8yz7NKDNI1rv4GwNo9VLhBfciPlhpSja/sSgMQZMU8+gDFi+AGib2/NOHbU+wHWJa9nQM1/rl8ZSLP8JAi2KcubccRb58ox/ApsZjdoRPSStAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"querystring\" title=\"querystring\" src=\"/static/39f017c613310fc6eb18d1a830e339ef/37523/querystring.png\" srcset=\"/static/39f017c613310fc6eb18d1a830e339ef/e9ff0/querystring.png 180w,\n/static/39f017c613310fc6eb18d1a830e339ef/f21e7/querystring.png 360w,\n/static/39f017c613310fc6eb18d1a830e339ef/37523/querystring.png 720w,\n/static/39f017c613310fc6eb18d1a830e339ef/302a4/querystring.png 1080w,\n/static/39f017c613310fc6eb18d1a830e339ef/e6c84/querystring.png 1148w\" sizes=\"(max-width: 720px) 100vw, 720px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n<h2 id=\"더-알아볼-것-search-filter\" style=\"position:relative;\"><a href=\"#%EB%8D%94-%EC%95%8C%EC%95%84%EB%B3%BC-%EA%B2%83-search-filter\" aria-label=\"더 알아볼 것 search filter permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>더 알아볼 것… search filter</h2>\n<p>Django에서는 이러한 search에 대한 필터를 제공해준다. <code class=\"language-text\">django-filter</code> 라이브러리를 설치하고, filter_backends와 filterset_fields만 설정해주면 쿼리에 대한 질의를 알아서 해주는 것이다. 이것은 다음에 알아보도록 하자..</p>\n<h2 id=\"drf-정리\" style=\"position:relative;\"><a href=\"#drf-%EC%A0%95%EB%A6%AC\" aria-label=\"drf 정리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>DRF 정리</h2>\n<p>여태까지 장고에서 데이터를 처리하는 방법에 대하여 간단하게 알아보았다. 복습을 해보도록 하자.</p>\n<ol>\n<li>\n<p>클라이언트의 요청</p>\n<p>웹서버로 요청이 들어오면 <code class=\"language-text\">wsgi</code>인터페이스에서 장고의 맞는 적절한 url에 요청을 전달해준다. (보통 이때 cors middleware등이 필요하다면 개입)</p>\n</li>\n<li>\n<p>urls.py</p>\n<p>요청이 들어오면 <code class=\"language-text\">urls.py</code>에서 처리해준다. sub url이나 router class로 정의된 라우팅은 include를 통하여 <code class=\"language-text\">url patterns</code>에 매핑된다.</p>\n</li>\n<li>\n<p>views.py</p>\n<p>각 요청은 해당 app의 <code class=\"language-text\">views.py</code>에 있는 함수(Function Based View) 또는 클래스(Class Based View)와 매핑되어 실행된다.</p>\n</li>\n<li>\n<p>model.py</p>\n<p>서버에서 다루는 데이터 모델에 대한 스키마를 정의하는 파일로, 하나의 모델 클래스가 RDB에서의 한 테이블이 될 것이다.</p>\n</li>\n<li>\n<p>seraializers.py</p>\n<p>위에서 정의한 모델의 CRUD에 필요한 직렬화와 역직렬화를 위해 serializer클래스를 이용한다. (역)직렬화하는 방법을 정의할 수 있다.</p>\n</li>\n<li>\n<p>ModelViewSet</p>\n<p>CBV로 구현할 때, 모델에 대한 다양한 기능들을 지원해주는 클래스이다. <code class=\"language-text\">GenericViewSet</code> 클래스에서 CRUD에 필요한 기본적인 mixins 클래스까지 상속되어 있어, <code class=\"language-text\">queryset</code>과 <code class=\"language-text\">serializer_class</code>만 지원해주면 기본적인 요청을 처리할 수 있다. 각 요청에 대한 함수는 오버라이딩할 수 있다.</p>\n</li>\n</ol>\n<h1 id=\"브라우저와-연결하기\" style=\"position:relative;\"><a href=\"#%EB%B8%8C%EB%9D%BC%EC%9A%B0%EC%A0%80%EC%99%80-%EC%97%B0%EA%B2%B0%ED%95%98%EA%B8%B0\" aria-label=\"브라우저와 연결하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>브라우저와 연결하기</h1>\n<p>이제는 프론트엔드와 연결할 시간이다 ~ !</p>\n<p>오늘 진행할 프론트 소스코드는 <a href=\"https://github.com/choieastsea/market-guri-react/commit/dfb21bae78b94a86360db2135c1081f7e7b31ddb\">여기에 있다</a>. 미숙한 리액트 실력으로 간단하게 메인페이지를 만들어보았다. 메인페이지에서 아이템을 보여주도록 구현하려고 한다. localhost:3000에다가 띄워놓았고, 해당 페이지는 바로 <a href=\"http://localhost:8000/item/basic/\">http://localhost:8000/item/basic/</a> GET request를 보내도록 설계되어있다. 하지만 error가 나오고, 크롬 개발자 도구를 켜서 확인해보면 <code class=\"language-text\">CORS 에러</code>가 나오는 것을 확인할 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 35.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABYlAAAWJQFJUiTwAAAA9ElEQVQoz6WPz0rDQByElyCIeilGSlEDBjyIiicRU1Ra8AU8WNqk3ewm+syhh55CXiLN7idJiaSCf8CBYZbh+w2ssNZSK89zsixjuVxSFAWr1arpatVMy/0m0YJlWW4dGWM+x7r5p8Hu0X8ttvdtxz/pe05UFVSVZb021L80librzlS2ya9vazZMl2s7kaQhSs8IoxekfEXKCbGaopM5Kpmj0wU6lZt8k6gkQqsQrWaNF/EEGU951xFKR4jx6Q7DgcP9wCHwdnk42yfw9nj0XUYXxzxfeozP+4x8lyffZXhywN2RaBz0Bbeu4KYnuOoJrg8dPgC4EtCRtYmZgAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"cors\"\n        title=\"cors\"\n        src=\"/static/dba39126733cacb1f110f083cddc369a/37523/cors.png\"\n        srcset=\"/static/dba39126733cacb1f110f083cddc369a/e9ff0/cors.png 180w,\n/static/dba39126733cacb1f110f083cddc369a/f21e7/cors.png 360w,\n/static/dba39126733cacb1f110f083cddc369a/37523/cors.png 720w,\n/static/dba39126733cacb1f110f083cddc369a/302a4/cors.png 1080w,\n/static/dba39126733cacb1f110f083cddc369a/07a9c/cors.png 1440w,\n/static/dba39126733cacb1f110f083cddc369a/09d8d/cors.png 3012w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>chrome의 network 단에 들어가서 더 자세한 내용을 확인해보자.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 52.222222222222214%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAABJUlEQVQoz5WS65KCMAyFeREFuZZyl7YgpbKu7vs/0tlJVpzR0dH98U2TXpKTNN7p+4zz5QfTNONwsLCzg3MLjsuJV2sdjBlhzPARniwbuOWCwTroySITJeI0R5JJJooFtn6IzTbExn/gure9Qr5XlC30YNEqjUYplFWHXNaMyCtmFyYvCXbxDfI9PUyY3ReOyxlS1pwpjNLbhdV+hM78IEKaSSg9QhY1+x4pqZo9mk6ByidFeVGzHez+Hr1jTcIBhayw7wd0e4Nej+h6Wg+cJE7E3YNn+EF8F5h7aMYZ2kzcS7IJKnW99Cro4z4rzPKSFXWksh+41CgRiOLsrbpneKkouH9126NpFY8KjQ0Fow9aM38anOeQSlRmupVLiulz1sD/UfgLz/AmkUatklQAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"cors1\" title=\"cors1\" src=\"/static/06cb82fbbfa0303ce9825476a2efa235/37523/cors1.png\" srcset=\"/static/06cb82fbbfa0303ce9825476a2efa235/e9ff0/cors1.png 180w,\n/static/06cb82fbbfa0303ce9825476a2efa235/f21e7/cors1.png 360w,\n/static/06cb82fbbfa0303ce9825476a2efa235/37523/cors1.png 720w,\n/static/06cb82fbbfa0303ce9825476a2efa235/302a4/cors1.png 1080w,\n/static/06cb82fbbfa0303ce9825476a2efa235/07a9c/cors1.png 1440w,\n/static/06cb82fbbfa0303ce9825476a2efa235/6f464/cors1.png 1464w\" sizes=\"(max-width: 720px) 100vw, 720px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n<p><code class=\"language-text\">postman</code>에서는 잘되는데, 왜이럴까??!!</p>\n<h2 id=\"간단하게-알아보는-cors-에러\" style=\"position:relative;\"><a href=\"#%EA%B0%84%EB%8B%A8%ED%95%98%EA%B2%8C-%EC%95%8C%EC%95%84%EB%B3%B4%EB%8A%94-cors-%EC%97%90%EB%9F%AC\" aria-label=\"간단하게 알아보는 cors 에러 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>간단하게 알아보는 CORS 에러</h2>\n<blockquote>\n<p>Cross-Origin-Resource-Sharing</p>\n</blockquote>\n<p>api server와 front server를 분리한 경우에는 항상 발생할 수 밖에 없는 브라우저의 보안 정책이다.</p>\n<p>원칙적으로, 브라우저에서 일어나는 <code class=\"language-text\">AJAX request</code>는 <code class=\"language-text\">SOP</code>(Same Orign Policy)정책을 따른다. 즉, 같은 Origin끼리만 리소스를 공유할 수 있는 것이다. 따라서, 우리와 같이 origin이 다른 경우(<a href=\"http://localhost:3000%E2%86%94http://localhost:8000)%EC%97%90%EB%8A%94\">http://localhost:3000↔http://localhost:8000)에는</a> 이 정책에 의하여 정보 교환이 불가능해지는 것이다.</p>\n<p>이러한 정책이 있는 이유는 악의적인 의도에 있어서 서버를 보호하기 위함이다.(특정 사이트에 악성 코드가 우리 서버로 데이터를 마음껏 접근하도록 할 수 있으므로)</p>\n<p><code class=\"language-text\">safe method</code>로 인하여 장고에서 CORS 에러가 발생하는 단계는 간단하게 다음과 같다.</p>\n<ul>\n<li>\n<p>장고에서 origin을 검사한다</p>\n</li>\n<li>\n<p>origin이 현재 서버의 origin과 다르다면, CORS 에러를 발생시킨다</p>\n</li>\n<li>\n<p>이후, <strong>views.py로 연결이 되어 실행이 되기는 한다</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">list</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> request<span class=\"token punctuation\">,</span> <span class=\"token operator\">*</span>args<span class=\"token punctuation\">,</span> <span class=\"token operator\">**</span>kwargs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">.</span>META<span class=\"token punctuation\">[</span><span class=\"token string\">'HTTP_ORIGIN'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># CORS error가 발생하더라도 view가 실행됨</span>\n    <span class=\"token keyword\">return</span> <span class=\"token builtin\">super</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">,</span> <span class=\"token operator\">*</span>args<span class=\"token punctuation\">,</span> <span class=\"token operator\">**</span>kwargs<span class=\"token punctuation\">)</span></code></pre></div>\n<p>이 코드를 통해서 error가 발생하더라도 view 함수가 실행되는 것은 볼 수 있다.</p>\n</li>\n<li>\n<p>Response는 CORS 에러가 나오게 된다!</p>\n</li>\n</ul>\n<p>이러한 과정은 GET, POST와 같은 <code class=\"language-text\">safe method</code>에서 일어나게 된다. <strong>주의해야할 점은, 장고에서는 safe method(혹은 simple request라고도 함)에 있어서는 view 함수가 실행된다는 것이다!!</strong> 따라서, post나 get 요청으로는 (외부 공격을 막기 위해) 상태를 변경하는 것은 자제하도록 하자.</p>\n<p>PUT/UPDATE/DELETE와 같은 <code class=\"language-text\">unsafe method</code>의 경우에는 브라우저에서 요청을 2개(preflight, main request)로 나눠서 보내게 된다. 따라서, <strong>preflight 요청에서 browser에 의하여 본 요청은 수행되지 않고 CORS 에러를 일으키게 된다</strong>.</p>\n<p>CORS에러에 대한 설명은 <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS\">MDN docs</a>를 참고하도록 한다.</p>\n<blockquote>\n<p>&#x3C;요약></p>\n<ol>\n<li>request를 보내는 브라우저 클라이언트와 response를 처리하는 server의 ORIGIN이 다른 경우 CORS 에러가 발생한다</li>\n<li>SOP 정책을 사용하더라도 safe method의 경우, 장고는 view 함수가 실행될 수 있으니 주의한다</li>\n<li>unsafe method의 경우, 본 요청 이전의 preflight 요청에 의하여 view 함수가 실행되지 않고 CORS 에러가 발생할 것이다</li>\n<li>장고에서는 django-cors-headers 미들웨어의 CORS_ALLOWED_ORIGINS 리스트에 추가해주도록 하자.</li>\n</ol>\n</blockquote>\n<h2 id=\"그래서-django에서의-해결법은\" style=\"position:relative;\"><a href=\"#%EA%B7%B8%EB%9E%98%EC%84%9C-django%EC%97%90%EC%84%9C%EC%9D%98-%ED%95%B4%EA%B2%B0%EB%B2%95%EC%9D%80\" aria-label=\"그래서 django에서의 해결법은 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>그래서 django에서의 해결법은?</h2>\n<p>CORS를 허용하도록 하는 미들웨어를 설치한다. <code class=\"language-text\">pip install django-cors-headers</code></p>\n<p>settings.py에서 MIDDLEWARE에 다음을 추가한다. <code class=\"language-text\">'corsheaders.middleware.CorsMiddleware', </code> 그리고, <code class=\"language-text\">'django.middleware.common.CommonMiddleware',</code>도 없다면 추가해준다(아마 기본적으로 있긴 할 것) 만약 문제가 생긴다면 해당 미들웨어를 최상단으로 올리는 것을 권장한다고 한다.</p>\n<p>이후에 settings.py에다가 다음을 추가해준다. ORIGIN은 <code class=\"language-text\">{protocol}://{hostname}:{port}</code>의 형식을 의미한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">CORS_ORIGIN_WHITELIST <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token string\">'http://localhost:3000'</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span>\n<span class=\"token comment\"># 최근 버전에는 이를 사용한다</span>\nCORS_ALLOWED_ORIGINS <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token string\">'http://localhost:3000'</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span></code></pre></div>\n<p>둘 중 하나로 표기하면 된다. 만약 배포 환경이여도 url host를 적어주면 될 것이다. <code class=\"language-text\">\"*\"</code>로 표기하면 모든 요청에 대하여 허용해주는 것이므로 <strong>권장되지 않는다</strong>.</p>\n<p>추가적인 옵션들이 있는데, 이는 다음에 필요할때마다 넣어주도록 하자. <a href=\"https://pypi.org/project/django-cors-headers/\">django-cors-headers의 공식문서</a>를 참고한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 24.444444444444443%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAmUlEQVQY03WPUQqFIBBF2//WRCL6kxbgV2ipkab3cQUfGjQwIDPOmTOTlBLrukIIAaUUtm3DsiyY5xkpJbQopfzzHX1vOs8TWmscx1EBzOu6EGOEtRbGGDzPM8D4xzlX6znnEcgioYTw3Yf3vi4KIQyDBHIZofd9D5YTQc2wmbRh2u37XgG9xfvswbDpN8O+yRotef4b+AX/ARXJhkzaJ7nwAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"cors_solved\"\n        title=\"cors_solved\"\n        src=\"/static/7917f961f61be287c7245b807e207b1c/37523/cors_solved.png\"\n        srcset=\"/static/7917f961f61be287c7245b807e207b1c/e9ff0/cors_solved.png 180w,\n/static/7917f961f61be287c7245b807e207b1c/f21e7/cors_solved.png 360w,\n/static/7917f961f61be287c7245b807e207b1c/37523/cors_solved.png 720w,\n/static/7917f961f61be287c7245b807e207b1c/302a4/cors_solved.png 1080w,\n/static/7917f961f61be287c7245b807e207b1c/07a9c/cors_solved.png 1440w,\n/static/7917f961f61be287c7245b807e207b1c/4faaa/cors_solved.png 2308w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>이제 잘 나오는 것을 확인할 수 있다.</p>\n<p>오늘까지 아주 기본적인 장고의 개념과 기본적인 CRUD, 그리고 브라우저에 연결하는 방법까지 알아보았다.</p>\n<p>다음부터는 서비스와 관련하여 필요한 기능들(회원, CSRF, session, 권한)과 관련된 기능들을 공부해보도록 하자. 화이팅</p>\n<p><a href=\"https://github.com/choieastsea/market-guri-django/commit/704c0db7b26c0c6f63f15e709225c4ed82db4b47\">소스코드1</a></p>\n<p><a href=\"https://github.com/choieastsea/market-guri-django/commit/601c2a75fde10d60ccccbff724d08bfa1b7baa42\">소스코드2</a> (CORS 관련 수정한 커밋)</p>","frontmatter":{"date":"April 16, 2022","title":"(Django) 장고 api 서버를 이용한 프로젝트 [7-Search, 브라우저와 연결하기]","categories":"BE","author":"choieastsea","emoji":"🙄"},"fields":{"slug":"/Django(7)-Search&CORS/"}},"prev":{"id":"e0bdf019-16fc-5372-b49e-2db69640ff06","html":"<p>react로 이것저것 할때마다 가장 귀찮은 것 중 하나가 input을 다루는 일이였다. 회원가입페이지 등을 구성하면서, input을 객체로 갖고 관리하지만 중복되는 코드가 매우 많아 귀찮다. 그래서 customHook을 만들어보았는데, 케이스에 맞게 적용할 수 있을 것 같아 업로드한다.</p>\n<p>우선, 해당 hook에서 대응가능한 event는 다음과 같다.</p>\n<ul>\n<li>Text Input event</li>\n<li>Select event : mui를 이용하여 프론트를 구성하였기에 해당 이벤트를 처리하였음</li>\n<li>check event</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> SelectChangeEvent <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@mui/material'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> ChangeEvent<span class=\"token punctuation\">,</span> Dispatch<span class=\"token punctuation\">,</span> SetStateAction<span class=\"token punctuation\">,</span> useCallback<span class=\"token punctuation\">,</span> useState <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">SetState<span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token operator\">></span></span> <span class=\"token operator\">=</span> Dispatch<span class=\"token operator\">&lt;</span>SetStateAction<span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token operator\">>></span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token generic-function\"><span class=\"token function\">useInputObjectCallback</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span>\n  initialState<span class=\"token operator\">:</span> <span class=\"token constant\">T</span>\n<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n  <span class=\"token constant\">T</span><span class=\"token punctuation\">,</span>\n  SetState<span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">(</span>\n    e<span class=\"token operator\">:</span> ChangeEvent<span class=\"token operator\">&lt;</span>HTMLInputElement <span class=\"token operator\">|</span> HTMLTextAreaElement<span class=\"token operator\">></span> <span class=\"token operator\">|</span> SelectChangeEvent<span class=\"token operator\">&lt;</span><span class=\"token builtin\">string</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n    inputType<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span>\n  <span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">void</span>\n<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>state<span class=\"token punctuation\">,</span> setState<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token generic-function\"><span class=\"token function\">useState</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span>initialState<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> onChangeInput <span class=\"token operator\">=</span> <span class=\"token function\">useCallback</span><span class=\"token punctuation\">(</span>\n    <span class=\"token punctuation\">(</span>\n      e<span class=\"token operator\">:</span> ChangeEvent<span class=\"token operator\">&lt;</span>HTMLInputElement <span class=\"token operator\">|</span> HTMLTextAreaElement<span class=\"token operator\">></span> <span class=\"token operator\">|</span> SelectChangeEvent<span class=\"token operator\">&lt;</span><span class=\"token builtin\">string</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n      inputType<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span>\n    <span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> value<span class=\"token punctuation\">,</span> type<span class=\"token punctuation\">,</span> checked <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> e<span class=\"token punctuation\">.</span>target <span class=\"token keyword\">as</span> HTMLInputElement<span class=\"token punctuation\">;</span>\n      <span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>prevObj<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n        <span class=\"token operator\">...</span>prevObj<span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">[</span>inputType<span class=\"token punctuation\">]</span><span class=\"token operator\">:</span> type <span class=\"token operator\">===</span> <span class=\"token string\">'checkbox'</span> <span class=\"token operator\">?</span> checked <span class=\"token operator\">:</span> value<span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">[</span>state<span class=\"token punctuation\">,</span> setState<span class=\"token punctuation\">,</span> onChangeInput<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token punctuation\">{</span> useInputObjectCallback <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>사용법은 다음과 같다.</p>\n<p>우선, 인풋 객체와 초기화 객체를 만들어준다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token comment\">//model.ts</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">type</span> <span class=\"token class-name\">SignupInfo</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  username<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n  password<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n  passwordConfirm<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n  first_name<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n  last_name<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n  phone_number<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n  address<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> SignupInit<span class=\"token operator\">:</span> SignupInfo <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  username<span class=\"token operator\">:</span> <span class=\"token string\">''</span><span class=\"token punctuation\">,</span>\n  password<span class=\"token operator\">:</span> <span class=\"token string\">''</span><span class=\"token punctuation\">,</span>\n  passwordConfirm<span class=\"token operator\">:</span> <span class=\"token string\">''</span><span class=\"token punctuation\">,</span>\n  first_name<span class=\"token operator\">:</span> <span class=\"token string\">''</span><span class=\"token punctuation\">,</span>\n  last_name<span class=\"token operator\">:</span> <span class=\"token string\">''</span><span class=\"token punctuation\">,</span>\n  phone_number<span class=\"token operator\">:</span> <span class=\"token string\">''</span><span class=\"token punctuation\">,</span>\n  address<span class=\"token operator\">:</span> <span class=\"token string\">''</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>react input component에 사용할 때,</p>\n<ul>\n<li>custom hook을 호출하여 state, setState function, onChangeFunction을 할당받는다</li>\n<li>input 태그에 value는 <code class=\"language-text\">state.field_name</code>, onChange는 <code class=\"language-text\">(e)=>onChangeFunction(e, 'field_name')</code>으로 적어준다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"react\"><pre class=\"language-react\"><code class=\"language-react\">&lt;input\n\tplaceholder=&quot;아이디&quot;\n\tvalue={signupObj.username}\n\tonChange={(e) =&gt; onChangeSignupInput(e, &#39;username&#39;)}\n/&gt;\n\n&lt;OutlinedInput\n  placeholder=&quot;주소&quot;\n  value={signupObj.address}\n  onChange={(e) =&gt; onChangeSignupInput(e, &#39;address&#39;)}\n/&gt;</code></pre></div>\n<p>내가 주로 사용하는 mui에서도 편하게 사용이 가능하므로 input과 관련된 별도의 처리를 해주지 않아도 된다. 물론 validation을 해야한다면 onChange가 아닌 setState를 사용하면 될 것이다.</p>\n<p>필드네임을 문자열로 관리하는 것이 좋은 방법은 아니지만, 이렇게 하면 코드를 줄일 수 있다고 생각한다~!</p>","frontmatter":{"date":"April 23, 2022","title":"(React TS) 다양한 input을 다룰 수 있는 custom hook","categories":"FE","author":"choieastsea","emoji":"🙄"},"fields":{"slug":"/FE-input-custom-hook-ts/"}},"site":{"siteMetadata":{"siteUrl":"https://choieastsea.github.io","comments":{"utterances":{"repo":"choieastsea/choieastsea.github.io"}}}}},"pageContext":{"slug":"/Django(8)-User Model/","nextSlug":"/Django(7)-Search&CORS/","prevSlug":"/FE-input-custom-hook-ts/"}},
    "staticQueryHashes": ["1073350324","1956554647","2938748437"]}